---
title: "Story 6.2: implement-security-headers-and-csp-in-next-config"
status: Draft
owner: scrum-master
---

# Story 6.2 — Implement headers/CSP in `next.config.ts`

## Status
Approved

## Story
**As a** tech lead,
**I want** to implement baseline security headers and CSP in Next.js,
**so that** we ship safe defaults compatible with motion and analytics.

## Acceptance Criteria
1. Headers present: HSTS, Referrer-Policy, X-Content-Type-Options, Permissions-Policy, CSP baseline. [Source: architecture/04-infrastructure-and-deployment-topology.md#4.5]
2. CSP allows dev/preview needs (vercel.live) and Resend API for connect; tighten later. [Source: architecture/04-infrastructure-and-deployment-topology.md#4.5]
3. No blocking of GSAP/analytics; preview verifies expected behavior. [Source: architecture/02-frontend-application-architecture.md#2.4, #2.9]

## Tasks / Subtasks
- [ ] Add `headers()` in `next.config.ts` returning:
  - [ ] `Strict-Transport-Security: max-age=15552000; includeSubDomains; preload`
  - [ ] `Referrer-Policy: strict-origin-when-cross-origin`
  - [ ] `X-Content-Type-Options: nosniff`
  - [ ] `Permissions-Policy: camera=(), microphone=(), geolocation=()`
  - [ ] `Content-Security-Policy` baseline per architecture sample (script-src includes `vercel.live`; connect-src includes `https://api.resend.com`)
- [ ] Adjust CSP if remote images used via `next/image` `remotePatterns`

## Dev Notes

### Sample Implementation
- Follow the provided snippet and adjust for analytics and any remote hosts. [Source: architecture/04-infrastructure-and-deployment-topology.md#4.5]

### Motion Compatibility
- Keep CSP permissive initially for dev; tighten after GSAP/analytics verified. [Source: architecture/04-infrastructure-and-deployment-topology.md#4.5]

## Testing
- Verify headers appear in network responses in preview.
- Validate CSP doesn’t block required scripts/connections; adjust as needed.

## Change Log
| Date       | Version | Description                                    | Author |
|------------|---------|------------------------------------------------|--------|
| 2025-08-08 | 0.1     | Draft for security headers & CSP added         | SM     |

## Dev Agent Record
To be filled by the development agent during implementation.


