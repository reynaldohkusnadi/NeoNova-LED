---
title: "Story 3.1: implement-motion-hooks"
status: Draft
owner: scrum-master
---

# Story 3.1 — Implement `usePrefersReducedMotion` and `useGsapScrollTrigger`

## Status
Approved

## Story
**As a** developer,
**I want** reusable hooks for reduced-motion detection and GSAP + ScrollTrigger setup/teardown,
**so that** motion can be added safely with parity and without memory leaks.

## Acceptance Criteria
1. Reduced motion disables pin/scrub and returns early from timeline creation. [Source: architecture/02-frontend-application-architecture.md#2.4; prd/07-performance-accessibility-and-seo.md#7.2]
2. GSAP + ScrollTrigger loaded lazily via dynamic import; plugin registered once. [Source: architecture/02-frontend-application-architecture.md#2.4]
3. Timelines/ScrollTriggers cleaned on unmount; no leaks under React StrictMode. [Source: prd/06-features.md#6.8]
4. No animation tick > 50 ms; measure→mutate pattern. [Source: prd/07-performance-accessibility-and-seo.md#7.1]

## Tasks / Subtasks
- [ ] Implement `lib/a11y/usePrefersReducedMotion.ts`
  - [ ] Use `(prefers-reduced-motion: reduce)` media query with change listener
  - [ ] SSR guard (return `true` only after mount if unknown)
- [ ] Implement `lib/motion/useGsapScrollTrigger.ts`
  - [ ] Lazy import `gsap` and `gsap/ScrollTrigger`; register plugin idempotently
  - [ ] Provide API to create timeline/ScrollTrigger and return a cleanup function
  - [ ] StrictMode-safe double-mount protection; defensive null checks
- [ ] Add minimal usage examples in JSDoc for components to follow
- [ ] Verify no global listeners remain after unmount

## Dev Notes

### Motion System & Parity
- Lazy-load GSAP and ScrollTrigger; gate timelines behind reduced motion. [Source: architecture/02-frontend-application-architecture.md#2.4]
- Reduced motion must bypass creation and provide static alternatives. [Source: prd/07-performance-accessibility-and-seo.md#7.2]

### Performance Discipline
- Ensure no long tasks > 50 ms per tick; avoid heavy work in rAF; throttle scroll handlers. [Source: architecture/02-frontend-application-architecture.md#2.7; prd/07-performance-accessibility-and-seo.md#7.1]

## Testing
- Unit: `usePrefersReducedMotion` returns `true` when media query matches; updates on change.
- Integration: mount/unmount a test component using `useGsapScrollTrigger`; verify cleanup (no leftover ScrollTriggers).
- Manual: Toggle OS reduced motion; confirm timelines skip.

## Change Log
| Date       | Version | Description                         | Author |
|------------|---------|-------------------------------------|--------|
| 2025-08-08 | 0.1     | Draft for motion hooks implementation | SM     |

## Dev Agent Record
To be filled by the development agent during implementation.


