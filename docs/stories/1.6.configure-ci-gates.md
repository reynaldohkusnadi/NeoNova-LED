---
title: "Story 1.6: configure-ci-gates"
status: Draft
owner: scrum-master
---

# Story 1.6 — Configure CI gates (typecheck, lint, Lighthouse CI, axe-core)

## Status
Approved

## Story
**As a** developer,
**I want** to configure and enforce CI gates for typecheck, lint, Lighthouse CI, and axe-core in Preview/Prod,
**so that** quality thresholds are enforced before merges and deployments.

## Acceptance Criteria
1. Build and dev server run locally with documented steps.
2. Page renders with RSC-first layout and placeholder sections.
3. Content read exclusively from `/content/site.ts`.
4. CI passes on Preview; baseline Lighthouse ≥90, axe: no criticals.

## Tasks / Subtasks
- [x] Set up CI workflow to run `pnpm install && pnpm typecheck && pnpm lint`
- [x] Integrate Lighthouse CI (desktop + Moto emulation) with Perf ≥ 90 threshold
- [x] Add axe-core accessibility check with “no criticals” rule
- [ ] Add bundle guard reporting (app shell JS gzip ≤ 140 KB; 3D payload report) to CI logs
- [ ] Mark checks as required for merges to `main`; allow override only with approval

## Dev Notes

### CI Steps & Thresholds
- Preview and production CI steps with specific thresholds and budgets. [Source: architecture/04-infrastructure-and-deployment-topology.md#4.3]

### Performance Budgets
- App shell JS ≤ 140 KB (gzip) and 3D payload ≤ 1.2 MB on first load. [Source: architecture/02-frontend-application-architecture.md#2.7; prd/07-performance-accessibility-and-seo.md#7.1]

### Accessibility
- Axe-core a11y checks with no critical violations; keyboard parity maintained across components. [Source: prd/07-performance-accessibility-and-seo.md#7.2]

## Testing
- Verify CI workflow runs all steps and enforces thresholds on PRs.
- Confirm failing checks block merges and that override requires explicit approval.

## Change Log
| Date       | Version | Description                     | Author |
|------------|---------|---------------------------------|--------|
| 2025-08-08 | 0.1     | Draft for CI gate configuration | SM     |

## Dev Agent Record
Agent Model Used: dev

Tasks / Subtasks Checkboxes:
- CI base steps configured: [x]
- Lighthouse and axe checks wired: [x]
- Bundle/budget guard: [ ]
- Branch protections: [ ]

Debug Log References:
- Added `.github/workflows/ci.yml`, `lighthouserc.json`.

Completion Notes:
- Bundle guard scripts still needed; consider `nextjs-bundle-analysis` or custom report.

File List:
- Added: `.github/workflows/ci.yml`, `lighthouserc.json`


